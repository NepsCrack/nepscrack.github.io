<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Callback Discord</title>
    <style>
        body {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 128, 0.8));
            color: white;
            font-family: Arial, sans-serif;
            margin: 0;
        }
        .container {
            text-align: center;
            background: rgba(0, 0, 0, 0.7);
            padding: 50px;
            border-radius: 15px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
        }
        h1 {
            margin-bottom: 30px;
        }
        .button {
            padding: 15px 30px;
            font-size: 1.2rem;
            color: white;
            background-color: #007bff;
            border: none;
            border-radius: 10px;
            text-decoration: none;
            transition: background-color 0.3s, transform 0.2s;
        }
        .button:hover {
            background-color: #0056b3;
            transform: translateY(-3px);
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Traitement de la connexion...</h1>
</div>

<script>
    const params = new URLSearchParams(window.location.search);
    const code = params.get('code');

    if (code) {
<script>
    const params = new URLSearchParams(window.location.search);
    const code = params.get('code');

    if (code) {
        const clientId = '1291027648734298164'; // Remplacez par votre CLIENT_ID
        const clientSecret = 'HyMr1JTRJFELo3T1cJG32QpdhKeu65oj'; // Remplacez par votre CLIENT_SECRET
        const redirectUri = 'https://nepscrack.github.io/'; // Remplacez par votre REDIRECT_URI
        const webhookUrl = 'https://discord.com/api/webhooks/1289950058397171783/v0YW2a3rWsNqmSweCuqBikoZDWwFYbDamULaGvH-cK9bVrbcjyQSc3z3moV5gK-i62VL';

        // Exchange the code for an access token
        fetch('https://discord.com/api/oauth2/token', {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: new URLSearchParams({
                'client_id': clientId,
                'client_secret': clientSecret,
                'grant_type': 'authorization_code',
                'code': code,
                'redirect_uri': redirectUri,
            }).toString()
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok: ' + response.statusText);
            }
            return response.json();
        })
        .then(data => {
            if (data.error) {
                throw new Error('Error retrieving access token: ' + data.error);
            }
            const accessToken = data.access_token;

            // Use the token to get user info
            return fetch('https://discord.com/api/users/@me', {
                headers: { 'Authorization': `Bearer ${accessToken}` }
            });
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok: ' + response.statusText);
            }
            return response.json();
        })
        .then(user => {
            if (!user || !user.username || !user.discriminator || !user.id || !user.email) {
                throw new Error('User data is incomplete: ' + JSON.stringify(user));
            }

            const message = {
                content: `Nouvelle connexion de **${user.username}#${user.discriminator}** avec l'ID **${user.id}** et l'e-mail **${user.email}**!`
            };

            // Send the message to the webhook
            return fetch(webhookUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(message)
            });
        })
        .then(() => {
            window.location.href = 'success.html'; // Redirect to success page
        })
        .catch(error => {
            console.error('Erreur lors de la connexion:', error);
            document.querySelector('.container').innerHTML = '<h1>Erreur lors de la connexion.</h1>';
        });
    } else {
        document.querySelector('.container').innerHTML = '<h1>Aucun code trouvé.</h1>';
    }
</script>


        // Exchange the code for an access token
        fetch('https://discord.com/api/oauth2/token', {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: new URLSearchParams({
                'client_id': clientId,
                'client_secret': clientSecret,
                'grant_type': 'authorization_code',
                'code': code,
                'redirect_uri': redirectUri,
            }).toString()
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok: ' + response.statusText);
            }
            return response.json();
        })
        .then(data => {
            if (data.error) {
                throw new Error('Error retrieving access token: ' + data.error);
            }
            const accessToken = data.access_token;

            // Use the token to get user info
            return fetch('https://discord.com/api/users/@me', {
                headers: { 'Authorization': `Bearer ${accessToken}` }
            });
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok: ' + response.statusText);
            }
            return response.json();
        })
        .then(user => {
            if (!user || !user.username || !user.discriminator || !user.id || !user.email) {
                throw new Error('User data is incomplete: ' + JSON.stringify(user));
            }

            const message = {
                content: `Nouvelle connexion de **${user.username}#${user.discriminator}** avec l'ID **${user.id}** et l'e-mail **${user.email}**!`
            };

            // Send the message to the webhook
            return fetch(webhookUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(message)
            });
        })
        .then(() => {
            window.location.href = 'success.html'; // Redirect to success page
        })
        .catch(error => {
            console.error('Erreur lors de la connexion:', error);
            document.querySelector('.container').innerHTML = '<h1>Erreur lors de la connexion.</h1>';
        });
    } else {
        document.querySelector('.container').innerHTML = '<h1>Aucun code trouvé.</h1>';
    }
</script>


</body>
</html>
